# Haste-Server with S3 integration

This example will deploy a pastebin service that will use HyperCloud S3 as the
storage backend.

The main file we are going to be deploying is [kubernetes/haste-server/haste-server.yaml],
which will be deploying an instance of [haste-server], configured to store
all data on HyperCloud object storage.

The file mentioned above is a template that is getting all the variables from
[ansible/inventory/group_vars/all.yaml]. You can modify all the `haste_*`
variables to match your environment:

- `haste_s3_*`: Your S3 connection details of your HyperCloud environment
- `haste_domain_name`: The domain pointing to the **public IP** of your
  Kubernetes cluster.
- 'letsencrypt_email': The email used to register your SSL certs with
  Let's Encrypt.

The Ingress to this service is configured with SSL certificates automatically
generated by Let's Encrypt. For this to work, we will need to install
`cert-manager` first into the Kubernetes cluster.

To simplify all this, you can run the following Ansible script which will deploy
everything. Again, from the `ansible/` folder.

    ansible-playbook -i inventory/hosts deploy_haste_kubernetes.yaml

[kubernetes/haste-server/haste-server.yaml]: kubernetes/haste-server/haste-server.yaml
[haste-server]: https://github.com/toptal/haste-server
[ansible/inventory/group_vars/all.yaml]: ansible/inventory/group_vars/all.yaml
